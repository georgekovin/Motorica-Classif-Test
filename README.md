# Motorica-Classif-Test

Компания Моторика, совместно с SkillFactory проводит стажировку.
Чтобы на нее попасть, нужно выполнить следующее тестовое задание:

**Необходимо построить модель распознавания жестов в парадигме обучения с учителем. Параметры модели должны быть оптимизированы на предложенных данных для обучения**


## Описание данных
**Пилот** - человек, с которого собираются данные.

На руку пилота крепится манжета с датчиками, которые фиксируют движение мышц и связок руки пилота. В течение всей процедуры сбора данных зафиксированные датчиками данные записываются в файл.
Пилоту поступают команды о выполнении жестов, пилот после получения команды с некоторой естественной задержкой выполняет жесты.

**Данные** представляют из себя *временные ряды*, где в каждый момент времени фиксируются показания от датчиков.

**Целевая переменная** представляет из себя закодированную команду поданную пользователю на выполнение жеста в каждый момент времени.

## Файлы
`X_train.npy` - обучающая выборка;\
`y_train.csv` - закодированная команда жеста для обучающей выборки;

*В данной постановке мы работаем с командами подаваемыми пользователю на выполнение жеста. Если есть команда "жест grab", значит в этот момент пользователь получил команду на выполнение схвата. Аналогично и остальные жесты, кроме "жеста open", который обозначает, что пользователь получил команду на возвращение руки в нейтральное состояние (раскрытая ладонь).*

`X_test.npy` - тестовая выборка;\
`sample_submission.csv` - некоторое решение задачи из которого можно взять формат;

*В тестовых данных целевая переменная отражает не команду для пользователя, а само выполнение жеста без задержки между получением пользователем команды и непосредственно выпонением жеста.*

---

`X_train.npy` и `X_test.npy` имеют следующие размерности:

    (наблюдения, датчики, время)

`y_train.csv` и `sample_submission.csv` имеют следующие размерности (*Это обусловленно форматом ответов для Kaggle*): 

    (наблюдения, время)

Последние содержат следующие классы:\
**0** - команда "жест open";\
**1** - команда "сгиб мизинца";\
**2** - команда "сгиб безымянного пальца";\
**3** - команда "сгиб среднего пальца";\
**4** - команда "жест пистолет";\
**5** - команда "сгиб указательного пальца";\
**6** - команда "сгиб большога пальца";\
**7** - команда "жест ОК";\
**8** - команда "жест grab";

## Задача
Предсказать, **какая команда была выполнена пользователем**.


## Итог работы

По итогу работы я создал модель **Стохастического градиентного спуска** . Согласно метрике **F1** она имеет показатели:
- **0.82** на тестовой выборке 
- **0.81** при кросс-валидации 

То есть модель угадывает правильный класс в **>80%** случаев, это довольно неплохая точность, и при этом оптимально обучена, не допуская недо- или переобучения. 

Создавал я ее с помощью библиотеки `sklearn`, модуль `linear_model`, класс `SGDClassifier`. Имеет моя модель следующий вид:

```python
SGDClassifier(alpha=0.01, 
              eta0=10, 
              learning_rate='adaptive', 
              n_jobs=-1,
              random_state=3)
```

Также данная модель помещена в **пайплайн**, который состоит из 3 шагов:
- *reshaper*, `TensorToMatrix`: мой авторский трансформер, который переводит данные в удобный для обучения вид.
- *scaler*, `StandardScaler`: стандартизация данных.
- *model*,  `SGDClassifier`: собственно, вышеописанная модель. 

Данный пайплайн реализован в классе **`MotoricaPipeline`** (по адресу `model/motorica_pl.py`), который имеет возможность принимать и выдавать данные в оригинальном формате без каких либо потерь.